#Se desea saber si el ingreso percibido por el empleado depende de la edad que tenga
#Con base a la poblaci칩n ocupada y que tiene edad de laborar se realizo la estimacion de los parametros
#que indicar치n cual es la relacion entre estas variables
#Variables:
#x=edad laborable (entre 15 y 65 a침os)
#y=ingreso que percibe

install.packages("foreign")
library(foreign)
install.packages("questionr")
library(questionr) 

base_completa<-read.dbf("C:\\Users\\HP\\Desktop\\Laura Narvaez\\sdemt117.DBF")
class(base_completa$EDA)
base_completa$EDA<-as.numeric(base_completa$EDA)
class(base_completa$EDA)

#se filtra dadas las especificaciones de la base
edad_ingreso<-subset(base_completa,(EDA >= 15 & EDA <= 65) & (R_DEF == "00") & (C_RES == "1" | C_RES =="3")& (CLASE2=="1"))
edad_ingreso<-data.frame(edad_ingreso$INGOCUP,edad_ingreso$EDA) #crea una base nueva
edad_ingreso$X<-edad_ingreso$edad_ingreso.EDA
edad_ingreso$Y<-edad_ingreso$edad_ingreso.INGOCUP
View(edad_ingreso)

install.packages("stats")
library(stats)
regresion<-lm(Y~X,edad_ingreso)
summary(regresion)
plot(edad_ingreso$X,edad_ingreso$Y,xlab="edades",ylab="ingresos percibidos")
abline(regresion)

#Conclusi칩n
#se puede ver que el ingreso esta determinado por la edad en la que se labora 
#la ecuacion para estos datos es: y=3500.641+25.333x

Sxx<-sum((x)^2)-(sum(x))^2/158775
Sxy<-sum(x*y)-((sum(x))*(sum(y)))/20
Beta1<-Sxy/Sxx
Beta0<-mean(y)-(Beta1*mean(x))
#y ajustado
y0<-Beta0+(Beta1*x)
SSE<-sum((y-y0)^2)
Sigma2<-(SSE/18)
